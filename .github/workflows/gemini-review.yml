name: "GEMINI CODE REVIEW"

on:
  issue_comment:
    types: [created]

permissions:
  contents: read
  pull-requests: write

jobs:
  gemini-code-review:
    runs-on: ubuntu-latest
    if: |
      github.event.issue.pull_request && (
        startsWith(github.event.comment.body, '/review') ||
        startsWith(github.event.comment.body, '/gemini-review')
      )
    steps:
      - name: Run Detailed Gemini Code Review
        uses: google-github-actions/run-gemini-cli@v0.1.3
        with:
          gemini_api_key: ${{ secrets.GEMINI_API_KEY }}
          # ðŸ’¡ The command is modified to include a custom prompt for detailed feedback
          command: >
            --repository ${{ github.repository }} 
            --pull-request ${{ github.event.issue.number }} 
            --prompt "Act as a meticulous Senior Software Engineer. Provide a comprehensive, file-by-file review. Highlight ALL issues, including security, performance, correctness, and style. For every suggestion, explain WHY the current code is wrong or suboptimal and provide a clear, actionable fix."